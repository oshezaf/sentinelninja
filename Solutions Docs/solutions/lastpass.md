# LastPass

## Solution Information

| Attribute | Value |
|:------------------------|:------|
| **Publisher** | The Collective Consulting |
| **Support Tier** | Partner |
| **Support Link** | [https://thecollective.eu](https://thecollective.eu) |
| **Categories** | domains |
| **First Published** | 2021-10-20 |
| **Last Updated** | 2022-01-12 |
| **Solution Folder** | [https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/LastPass](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/LastPass) |

## Data Connectors

This solution provides **1 data connector(s)**:

- [LastPass Enterprise - Reporting (Polling CCP)](../connectors/lastpass-polling.md)

## Tables Reference

This solution uses **2 table(s)**:

| Table | Used By Connectors | Used By Content |
|-------|-------------------|----------------|
| [`LastPassNativePoller_CL`](../tables/lastpassnativepoller-cl.md) | [LastPass Enterprise - Reporting (Polling CCP)](../connectors/lastpass-polling.md) | Analytics, Hunting, Workbooks |
| [`ThreatIntelligenceIndicator`](../tables/threatintelligenceindicator.md) | - | Analytics |

## Content Items

This solution includes **10 content item(s)**:

| Content Type | Count |
|:-------------|:------|
| Analytic Rules | 5 |
| Hunting Queries | 3 |
| Workbooks | 1 |
| Watchlists | 1 |

### Analytic Rules

| Name | Severity | Tactics | Tables Used |
|:-----|:---------|:--------|:------------|
| [Employee account deleted](../content/8a2cc466-342d-4ebb-8871-f9e1d83a24a5.md) | Medium | Impact | [`LastPassNativePoller_CL`](../tables/lastpassnativepoller-cl.md) |
| [Failed sign-ins into LastPass due to MFA](../content/760b8467-e6cc-4006-9149-5696845c1a54.md) | Low | InitialAccess | [`LastPassNativePoller_CL`](../tables/lastpassnativepoller-cl.md) |
| [Highly Sensitive Password Accessed](../content/b39e6482-ab7e-4817-813d-ec910b64b26e.md) | Medium | CredentialAccess, Discovery | [`LastPassNativePoller_CL`](../tables/lastpassnativepoller-cl.md) |
| [TI map IP entity to LastPass data](../content/2a723664-22c2-4d3e-bbec-5843b90166f3.md) | Medium | Impact | [`LastPassNativePoller_CL`](../tables/lastpassnativepoller-cl.md)<br>[`ThreatIntelligenceIndicator`](../tables/threatintelligenceindicator.md) |
| [Unusual Volume of Password Updated or Removed](../content/a3bbdf60-0a6d-4cc2-b1d1-dd70aca184ce.md) | Low | Impact | - |

### Hunting Queries

| Name | Tactics | Tables Used |
|:-----|:--------|:------------|
| [Failed sign-ins into LastPass due to MFA.](../content/b43fc364-69fc-4d3e-8834-6743ab5725e9.md) | InitialAccess | [`LastPassNativePoller_CL`](../tables/lastpassnativepoller-cl.md) |
| [Login into LastPass from a previously unknown IP.](../content/d292d770-69a4-4399-9272-6e86c4e53e58.md) | InitialAccess | - |
| [Password moved to shared folders](../content/e70f1b22-acd1-493f-bba5-b28bea988940.md) | Collection | [`LastPassNativePoller_CL`](../tables/lastpassnativepoller-cl.md) |

### Workbooks

| Name | Tables Used |
|:-----|:------------|
| [LastPassWorkbook](../content/lastpassworkbook-lastpass.md) | [`LastPassNativePoller_CL`](../tables/lastpassnativepoller-cl.md) |

### Watchlists

| Name | Description | Tables Used |
|:-----|:------------|:------------|
| [HighlySensitivePasswords](../content/highlysensitivepasswords-lastpass.md) | - | - |

## Additional Documentation

> üìÑ *Source: [LastPass/README.md](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/LastPass/README.md)*

This repository contains all resources for the LastPass Microsoft Sentinel Solution.
The LastPass Solution is built in order to easily integrate LastPass with Microsoft Sentinel.

By deploying this solution, you'll be able to monitor activity within LastPass and be alerted when potential security events arise.
The solution consists out of the following resources:
- A codeless API connector to ingest data into Sentinel.
- One workbook to visualize some of the activity within LastPass
- Hunting Queries to look into potential security events
- Analytic Rules to generate alerts and incidents when potential malicious events happen

## Data Connector Deployment
The data connector will retrieve the LastPass Activity data through the LastPass Enterprise API.

Authentication is done through a LastPass Provisioning Hash API key which can be generated by a LastPass administrator by following the steps in the following [How To Article](https://support.logmeininc.com/lastpass/help/use-the-lastpass-provisioning-api-lp010068).

This is a codeless API connector. After the deployment of the ARM template, the connector will be available in the list to connect.
Input the API key and Microsoft Sentinel will start to pull in data.

## Workbook
The workbook contains visualizations about the activity within LastPass and provides an overview of the user activity.
This allows you to identify user with a high amount of activity.

Besides user activity, the sign-ins logs are correlated to point out sign-ins which were done from previously unknown IPs and admin activity is surfaced.

The workbook can be deployed by creating an empty workbook and adding the data from the Gallery template.

## Hunting
- Login into LastPass from a previously unknown IP.
- Failed sign-ins into LastPass due to MFA.
- Password moved to shared folders

## Analytic Rules
The solution currently includes five analytic rules:
- TI map IP entity to LastPass data
- Highly Sensitive Password Accessed
- Failed sign-ins into LastPass due to MFA
- Employee account deleted
- Unusual Volume of Password Updated or Removed

## Release Notes

| **Version** | **Date Modified (DD-MM-YYYY)** | **Change History**                                                         |
|-------------|--------------------------------|----------------------------------------------------------------------------|
| 3.0.0       | 07-11-2023                     | Modified text as there is rebranding from Azure Active Directory to Microsoft Entra ID.   |

---

**Browse:**

- [‚Üê Back to Solutions Index](../solutions-index.md)
- [Connectors Index](../connectors-index.md)
- [Tables Index](../tables-index.md)
- [Content Index](../content/content-index.md)
