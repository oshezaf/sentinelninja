# Apache Log4j Vulnerability Detection

## Solution Information

| Attribute | Value |
|:------------------------|:------|
| **Publisher** | Microsoft Corporation |
| **Support Tier** | Microsoft |
| **Support Link** | [https://support.microsoft.com/](https://support.microsoft.com/) |
| **Categories** | domains |
| **First Published** | 2021-12-15 |
| **Solution Folder** | [https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection) |

## Data Connectors

**This solution does not include data connectors.**

This solution may contain other components such as analytics rules, workbooks, hunting queries, or playbooks.

## Tables Reference

This solution queries **28 table(s)** from its content items:

| Table | Used By Content |
|-------|----------------|
| [`AADNonInteractiveUserSignInLogs`](../tables/aadnoninteractiveusersigninlogs.md) | Analytics |
| [`ASimWebSessionLogs`](../tables/asimwebsessionlogs.md) | Analytics |
| [`AWSCloudTrail`](../tables/awscloudtrail.md) | Analytics |
| [`AZFWApplicationRule`](../tables/azfwapplicationrule.md) | Analytics |
| [`ApacheHTTPServer_CL`](../tables/apachehttpserver-cl.md) | Analytics |
| [`AzureActivity`](../tables/azureactivity.md) | Analytics |
| [`AzureDiagnostics`](../tables/azurediagnostics.md) | Analytics, Hunting |
| [`CommonSecurityLog`](../tables/commonsecuritylog.md) | Analytics, Hunting |
| [`DeviceNetworkEvents`](../tables/devicenetworkevents.md) | Analytics |
| [`DnsEvents`](../tables/dnsevents.md) | Analytics |
| [`Event`](../tables/event.md) | Analytics |
| [`M365SecureScoreControls_CL`](../tables/m365securescorecontrols-cl.md) | Workbooks |
| [`MDfEExposureScore_CL`](../tables/mdfeexposurescore-cl.md) | Workbooks |
| [`MDfERecommendations_CL`](../tables/mdferecommendations-cl.md) | Workbooks |
| [`MDfEVulnerabilitiesList_CL`](../tables/mdfevulnerabilitieslist-cl.md) | Workbooks |
| [`OfficeActivity`](../tables/officeactivity.md) | Analytics |
| [`SecurityNestedRecommendation`](../tables/securitynestedrecommendation.md) | Analytics, Workbooks |
| [`SecurityResources`](../tables/securityresources.md) | Workbooks |
| [`SigninLogs`](../tables/signinlogs.md) | Analytics |
| [`SquidProxy_CL`](../tables/squidproxy-cl.md) | Analytics |
| [`Syslog`](../tables/syslog.md) | Hunting, Workbooks |
| [`VMConnection`](../tables/vmconnection.md) | Analytics |
| [`VectraStream_CL`](../tables/vectrastream-cl.md) | Analytics |
| [`W3CIISLog`](../tables/w3ciislog.md) | Analytics |
| [`barracuda_CL`](../tables/barracuda-cl.md) | Analytics |
| [`log4j_execve`](../tables/log4j-execve.md) | Hunting |
| [`meraki_CL`](../tables/meraki-cl.md) | Analytics |
| [`securityresources`](../tables/securityresources.md) | Workbooks |

### Internal Tables

The following **2 table(s)** are used internally by this solution's playbooks:

| Table | Used By Content |
|-------|----------------|
| [`SecurityAlert`](../tables/securityalert.md) | Workbooks |
| [`SecurityIncident`](../tables/securityincident.md) | Workbooks |

## Content Items

This solution includes **18 content item(s)**:

| Content Type | Count |
|:-------------|:------|
| Hunting Queries | 10 |
| Analytic Rules | 4 |
| Workbooks | 3 |
| Playbooks | 1 |

### Analytic Rules

| Name | Severity | Tactics | Tables Used |
|:-----|:---------|:--------|:------------|
| [Azure WAF matching for Log4j vuln(CVE-2021-44228)](../content/2de8abd6-a613-450e-95ed-08e503369fb3.md) | High | InitialAccess | [`AzureDiagnostics`](../tables/azurediagnostics.md) |
| [Log4j vulnerability exploit aka Log4Shell IP IOC](../content/6e575295-a7e6-464c-8192-3e1d8fd6a990.md) | High | CommandAndControl | [`AADNonInteractiveUserSignInLogs`](../tables/aadnoninteractiveusersigninlogs.md)<br>[`AWSCloudTrail`](../tables/awscloudtrail.md)<br>[`AzureActivity`](../tables/azureactivity.md)<br>[`AzureDiagnostics`](../tables/azurediagnostics.md)<br>[`CommonSecurityLog`](../tables/commonsecuritylog.md)<br>[`DeviceNetworkEvents`](../tables/devicenetworkevents.md)<br>[`DnsEvents`](../tables/dnsevents.md)<br>[`Event`](../tables/event.md)<br>[`OfficeActivity`](../tables/officeactivity.md)<br>[`SigninLogs`](../tables/signinlogs.md)<br>[`VMConnection`](../tables/vmconnection.md)<br>[`W3CIISLog`](../tables/w3ciislog.md) |
| [User agent search for log4j exploitation attempt](../content/29283b22-a1c0-4d16-b0a9-3460b655a46a.md) | High | InitialAccess | [`ASimWebSessionLogs`](../tables/asimwebsessionlogs.md)<br>[`AZFWApplicationRule`](../tables/azfwapplicationrule.md)<br>[`ApacheHTTPServer_CL`](../tables/apachehttpserver-cl.md)<br>[`CommonSecurityLog`](../tables/commonsecuritylog.md)<br>[`SquidProxy_CL`](../tables/squidproxy-cl.md)<br>[`VectraStream_CL`](../tables/vectrastream-cl.md)<br>[`W3CIISLog`](../tables/w3ciislog.md)<br>[`barracuda_CL`](../tables/barracuda-cl.md)<br>[`meraki_CL`](../tables/meraki-cl.md) |
| [Vulnerable Machines related to log4j CVE-2021-44228](../content/3d71fc38-f249-454e-8479-0a358382ef9a.md) | High | InitialAccess, Execution | [`SecurityNestedRecommendation`](../tables/securitynestedrecommendation.md) |

### Hunting Queries

| Name | Tactics | Tables Used |
|:-----|:--------|:------------|
| [Azure WAF Log4j CVE-2021-44228 hunting](../content/1d4d383e-0ca6-4d3a-a861-8f37aeef18cb.md) | InitialAccess | [`AzureDiagnostics`](../tables/azurediagnostics.md) |
| [Linux security related process termination activity detected](../content/020b05d3-6447-402c-87b6-f8faff7c7e19.md) | DefenseEvasion | [`Syslog`](../tables/syslog.md) |
| [Malicious Connection to LDAP port for CVE-2021-44228 vulnerability](../content/19abc034-139e-4e64-a05d-cb07ce8b003b.md) | CommandAndControl | - |
| [Network Connection to New External LDAP Server](../content/bf094505-fd2e-484f-b72a-acd79ee00ce8.md) | InitialAccess | [`CommonSecurityLog`](../tables/commonsecuritylog.md) |
| [Possible Container Miner related artifacts detected](../content/6fee32b3-3271-4a3f-9b01-dbd9432a1707.md) | Impact, Execution | [`Syslog`](../tables/syslog.md) |
| [Possible Linux attack toolkit detected via Syslog data](../content/09e45ec6-ac42-4b5a-be69-54623c4aa062.md) | Reconnaissance, Execution | [`Syslog`](../tables/syslog.md) |
| [Possible exploitation of Apache log4j component detected](../content/38cc38c3-bd6c-470e-ae1a-3136a9ded97f.md) | Persistence, Execution | [`Syslog`](../tables/syslog.md)<br>[`log4j_execve`](../tables/log4j-execve.md) |
| [Suspicious Base64 download activity detected](../content/78882f9a-f3ef-4010-973c-3f6336f5bef7.md) | Persistence, Execution | [`Syslog`](../tables/syslog.md) |
| [Suspicious Shell script detected](../content/3e43fe23-c6c0-45ca-b680-263e8afada95.md) | Persistence, Execution | [`Syslog`](../tables/syslog.md) |
| [Suspicious manipulation of firewall detected via Syslog data](../content/e178baf5-3cf3-4960-8ca4-8da6d90d8206.md) | DefenseEvasion | [`Syslog`](../tables/syslog.md) |

### Workbooks

| Name | Tables Used |
|:-----|:------------|
| [Log4j](../content/log4j-apache-log4j-vulnerability-detection.md) | - |
| [Log4jImpactAssessment](../content/log4jimpactassessment-apache-log4j-vulnerability-detection.md) | [`M365SecureScoreControls_CL`](../tables/m365securescorecontrols-cl.md)<br>[`MDfEExposureScore_CL`](../tables/mdfeexposurescore-cl.md)<br>[`MDfERecommendations_CL`](../tables/mdferecommendations-cl.md)<br>[`MDfEVulnerabilitiesList_CL`](../tables/mdfevulnerabilitieslist-cl.md)<br>[`SecurityResources`](../tables/securityresources.md)<br>[`securityresources`](../tables/securityresources.md)<br>*Internal use:*<br>[`SecurityAlert`](../tables/securityalert.md)<br>[`SecurityIncident`](../tables/securityincident.md) |
| [Log4jPostCompromiseHunting](../content/log4jpostcompromisehunting-apache-log4j-vulnerability-detection.md) | [`SecurityNestedRecommendation`](../tables/securitynestedrecommendation.md)<br>[`Syslog`](../tables/syslog.md) |

### Playbooks

| Name | Description | Tables Used |
|:-----|:------------|:------------|
| [Log4jIndicatorProcessor](../content/log4jindicatorprocessor-apache-log4j-vulnerability-detection.md) | These playbooks automate the ingest of threat indicators into the ThreatIntelligenceIndicator table ... | - |

## Release Notes

| **Version** | **Date Modified (DD-MM-YYYY)** | **Change History**                                                         |
|-------------|--------------------------------|----------------------------------------------------------------------------|
| 3.0.8       | 25-08-2025                     | Hardcoded the **Watchlist** description to resolve a deployment issue.|
| 3.0.7       | 21-07-2025                     | Removed 'BatchImportToSentinel' & Updated 'Log4jIndicatorProcessor' **Playbook** to handle new STIX action.                 |
| 3.0.6       | 21-01-2025                     | Fixed query in  **Analytical Rule** UserAgentSearch_log4j.yaml.             |
| 3.0.5       | 26-07-2024                     | Updated **Analytical Rule** for missing TTP. 								|
| 3.0.4       | 31-05-2024                     | Added missing AMA **Data Connector** reference in **Analytic rules** and **Hunting Query**.      |
| 3.0.3       | 15-02-2024                     | Updated the solution to fix **Analytic Rules** deployment issue.            |
| 3.0.2       | 07-02-2024                     | Updated solution description.                                               |
| 3.0.1       | 02-01-2024                     | Tagged for dependent solutions for deployment.                              |
| 3.0.0       | 06-11-2023                     | Modified text as there is rebranding from Azure Active Directory to Microsoft Entra ID.   |

---

**Browse:**

- [‚Üê Back to Solutions Index](../solutions-index.md)
- [Connectors Index](../connectors-index.md)
- [Tables Index](../tables-index.md)
- [Content Index](../content-index.md)
