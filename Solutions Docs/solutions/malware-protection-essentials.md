# <img src="../images/asim-badge.png" alt="ASIM" height="32"> Malware Protection Essentials

<img src="https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/Azure_Sentinel.svg" alt="Malware Protection Essentials Logo" width="75" height="75">

Malware Protection Essentials is a [domain solution](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fdocs.microsoft.com%2Fazure%2Fsentinel%2Fsentinel-solutions-catalog%23domain-solutions&data=05%7C01%7Ckavishbakshi%40microsoft.com%7Cbe2a496082b24caa4b8c08da9cefacca%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637994850502413731%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=OJegu%2B2EqD7rmYmK9pm9QniD6YWp5ooloZ6tHzcwVi0%3D&reserved=0) and does not include any data connectors. The content in this solution requires one of the product solutions below , as well as any other connector or data source normalized to the [ASIM](https://aka.ms/AboutASIM).

**Prerequisite :-**

 Install one or more of the listed solutions, or develop your custom ASIM parsers to unlock the value provided by this solution.
 1. Amazon Web Services 
 2. Azure Firewall 
 3. Azure Network Security Groups 
 4. Check Point 
 5. Cisco ASA 
 6. Cisco Meraki Security Events 
 7. Corelight 
 8. Fortinet FortiGate 
 9. Microsoft Defender for IoT 
 10. Microsoft Defender for Cloud 
 11. Microsoft Sysmon For Linux 
 12. Windows Firewall 
 13. Palo Alto PANOS 
 14. Vectra AI Stream 
 15. WatchGuard Firebox 
 16. Zscaler Internet Access 

**Underlying Microsoft Technologies used:** 

This solution takes a dependency on the following technologies, and some of these dependencies either may be in Preview state or might result in additional ingestion or operational costs: 
 1. Product solutions as described above 
 2. Logic app for data summarization

**Recommendation :-**

It is highly recommended to use the **Summarize data** logic app playbook provided with this solution as it will significantly improve the performance of the Workbook, Analytic rules & Hunting queries.

## Solution Information

| Attribute | Value |
|:------------------------|:------|
| **Publisher** | Microsoft Corporation |
| **Support Tier** | Microsoft |
| **Support Link** | [https://support.microsoft.com](https://support.microsoft.com) |
| **Categories** | domains |
| **Version** | 3.0.1 |
| **Author** | Microsoft - support@microsoft.com |
| **First Published** | 2023-09-25 |
| **Last Updated** | 2023-09-25 |
| **Solution Folder** | [https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Malware%20Protection%20Essentials) |
| **Dependencies** | [Amazon Web Services](amazon-web-services.md), [Azure Firewall](azure-firewall.md), [Azure Network Security Groups](azure-network-security-groups.md), [Check Point](check-point.md), [CiscoASA](ciscoasa.md), [CiscoMeraki](ciscomeraki.md), [Corelight](corelight.md), Fortinet FortiGate Next-Generation Firewall connector for Microsoft Sentinel, [IoTOTThreatMonitoringwithDefenderforIoT](iototthreatmonitoringwithdefenderforiot.md), [Microsoft Defender for Cloud](microsoft-defender-for-cloud.md), [Microsoft Sysmon For Linux](microsoft-sysmon-for-linux.md), [Windows Firewall](windows-firewall.md), [PaloAlto-PAN-OS](paloalto-pan-os.md), [Vectra AI Stream](vectra-ai-stream.md), [Watchguard Firebox](watchguard-firebox.md), [Zscaler Internet Access](zscaler-internet-access.md) |

## <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> Supported Products

This solution uses ASIM parsers and supports the following products:

| Product |
|:--------|
| [Google Workspace](../asim/asim-products-index.md#google-workspace) |
| [Microsoft 365 Defender for EndPoint](../asim/asim-products-index.md#microsoft-365-defender-for-endpoint) |
| [Microsoft 365 Defender for Endpoint](../asim/asim-products-index.md#microsoft-365-defender-for-endpoint) |
| [Microsoft 365 Defender for endpoint](../asim/asim-products-index.md#microsoft-365-defender-for-endpoint) |
| [Microsoft Azure Blob Storage](../asim/asim-products-index.md#microsoft-azure-blob-storage) |
| [Microsoft Azure File Storage](../asim/asim-products-index.md#microsoft-azure-file-storage) |
| [Microsoft Azure Queue Storage](../asim/asim-products-index.md#microsoft-azure-queue-storage) |
| [Microsoft Azure Table Storage](../asim/asim-products-index.md#microsoft-azure-table-storage) |
| [Microsoft Defender for IoT](../asim/asim-products-index.md#microsoft-defender-for-iot) |
| [Microsoft SharePoint](../asim/asim-products-index.md#microsoft-sharepoint) |
| [Microsoft Sysmon](../asim/asim-products-index.md#microsoft-sysmon) |
| [Microsoft Sysmon for Linux](../asim/asim-products-index.md#microsoft-sysmon-for-linux) |
| [Microsoft Windows Events](../asim/asim-products-index.md#microsoft-windows-events) |
| [Microsoft Windows Events Sysmon](../asim/asim-products-index.md#microsoft-windows-events-sysmon) |
| [Native](../asim/asim-products-index.md#native) |
| [Security Events](../asim/asim-products-index.md#security-events) |
| [SentinelOne](../asim/asim-products-index.md#sentinelone) |
| [Sysmon](../asim/asim-products-index.md#sysmon) |
| [Sysmon for Linux](../asim/asim-products-index.md#sysmon-for-linux) |
| [Trend Micro Vision One](../asim/asim-products-index.md#trend-micro-vision-one) |
| [VMware Carbon Black Cloud](../asim/asim-products-index.md#vmware-carbon-black-cloud) |
| [Windows Sysmon](../asim/asim-products-index.md#windows-sysmon) |

## Data Connectors

**This solution does not include data connectors.**

This solution may contain other components such as analytics rules, workbooks, hunting queries, or playbooks.

## <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> ASIM Parsers Used

This solution uses **3 ASIM parser(s)** for normalized data:

| Table | Used By Content |
|-------|----------------|
| [`_ASim_FileEvent`](../asim/asimfileevent.md) | Hunting, Workbooks |
| [`_ASim_ProcessEvent`](../asim/asimprocessevent.md) | Analytics, Hunting, Workbooks |
| [`_ASim_RegistryEvent`](../asim/asimregistry.md) | Analytics, Workbooks |

## Tables Used

This solution queries **1 table(s)** from its content items:

| Table | Used By Content |
|-------|----------------|
| [`WindowsFirewall`](../tables/windowsfirewall.md) | Workbooks |

## Content Items

This solution includes **14 content item(s)**:

| Content Type | Count |
|:-------------|:------|
| Analytic Rules | 6 |
| Hunting Queries | 6 |
| Workbooks | 1 |
| Watchlists | 1 |

### Analytic Rules

| Name | Severity | Tactics | Tables Used |
|:-----|:---------|:--------|:------------|
| <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [Detect Malicious Usage of Recovery Tools to Delete Backup Files](../content/malware-protection-essentials-detect-malicious-usage-of-recovery-tools-to-delete-backup-files-259de2c1-c546-4c6d-a17c-df639722f4d7-f1d64838.md) | High | Impact | <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_ProcessEvent`](../asim/asimprocessevent.md) |
| <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [Detect Print Processors Registry Driver Key Creation/Modification](../content/malware-protection-essentials-detect-print-processors-registry-driver-key-creation-modification-7edde3d4-9859-4a00-b93c-b19ddda55320-f9f0f5d0.md) | Medium | Persistence, PrivilegeEscalation | <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_RegistryEvent`](../asim/asimregistry.md) |
| <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [Detect Registry Run Key Creation/Modification](../content/malware-protection-essentials-detect-registry-run-key-creation-modification-dd041e4e-1ee2-41ec-ba4e-82a71d628260-bcf60f87.md) | Medium | Persistence, PrivilegeEscalation, DefenseEvasion | <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_RegistryEvent`](../asim/asimregistry.md) |
| <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [Detect Windows Allow Firewall Rule Addition/Modification](../content/malware-protection-essentials-detect-windows-allow-firewall-rule-addition-modification-056593d4-ca3b-47a7-be9d-d1d0884a1d36-0da604bb.md) | Medium | DefenseEvasion | <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_RegistryEvent`](../asim/asimregistry.md) |
| <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [Detect Windows Update Disabled from Registry](../content/malware-protection-essentials-detect-windows-update-disabled-from-registry-f1443a87-78d5-40c3-b051-f468f0f2def0-9957e6e8.md) | Medium | DefenseEvasion | <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_RegistryEvent`](../asim/asimregistry.md) |
| <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [Process Creation with Suspicious CommandLine Arguments](../content/malware-protection-essentials-process-creation-with-suspicious-commandline-arguments-fdbcc0eb-44fb-467e-a51d-a91df0780a81-fc1c4a27.md) | Medium | Execution, DefenseEvasion | <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_ProcessEvent`](../asim/asimprocessevent.md) |

### Hunting Queries

| Name | Tactics | Tables Used |
|:-----|:--------|:------------|
| <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [Detect File Creation in Startup Folder](../content/malware-protection-essentials-detect-file-creation-in-startup-folder-64e199a8-b26c-462f-a65c-09ed9b53a47b-2d1178e6.md) | Persistence, PrivilegeEscalation, DefenseEvasion | <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_FileEvent`](../asim/asimfileevent.md) |
| <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [Detect Files with Ramsomware Extensions](../content/malware-protection-essentials-detect-files-with-ramsomware-extensions-595aea5c-74c7-415b-8b12-10af1a338cdf-d88185c4.md) | Execution, Impact | <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_FileEvent`](../asim/asimfileevent.md) |
| <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [Detect Modification to System Files or Directories by User Accounts](../content/malware-protection-essentials-detect-modification-to-system-files-or-directories-by-user-accounts-54b222c4-0149-421e-9d6d-da66da50495a-78cf8ebf.md) | DefenseEvasion, Persistence, PrivilegeEscalation | <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_FileEvent`](../asim/asimfileevent.md) |
| <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [Detect New Scheduled Task Creation that Run Executables From Non-Standard Location](../content/malware-protection-essentials-detect-new-scheduled-task-creation-that-run-executables-from-non-standard--b43394b9-fa91-4d98-b331-619926a933bb-d0df99aa.md) | Execution, PrivilegeEscalation, Persistence | <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_ProcessEvent`](../asim/asimprocessevent.md) |
| <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [Detect New Scheduled Task Entry Creations](../content/malware-protection-essentials-detect-new-scheduled-task-entry-creations-4dc0aae4-6375-4670-b138-8c42490ba206-84bcf125.md) | Execution, PrivilegeEscalation, Persistence | <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_FileEvent`](../asim/asimfileevent.md) |
| <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [Executable Files Created in Uncommon Locations](../content/malware-protection-essentials-executable-files-created-in-uncommon-locations-ab8ddb26-050c-40aa-aaf0-bfb7e3eeb05f-1af678b6.md) | Persistence, PrivilegeEscalation, DefenseEvasion | <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_FileEvent`](../asim/asimfileevent.md) |

### Workbooks

| Name | Tables Used |
|:-----|:------------|
| <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [MalwareProtectionEssentialsWorkbook](../content/malware-protection-essentials-malwareprotectionessentialsworkbook-df9a8a0a.md) | <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_FileEvent`](../asim/asimfileevent.md)<br><img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_ProcessEvent`](../asim/asimprocessevent.md)<br><img src="../images/asim-logo-small.png" alt="ASIM" height="16"> [`_ASim_RegistryEvent`](../asim/asimregistry.md)<br>[`WindowsFirewall`](../tables/windowsfirewall.md) |

### Watchlists

| Name | Description | Tables Used |
|:-----|:------------|:------------|
| [RansomwareFileExtensions](../content/malware-protection-essentials-ransomwarefileextensions-60fe6cb7.md) | - | - |

## Release Notes

| **Version**  | **Date Modified (DD-MM-YYYY)**  | **Change History**                          	|
|--------------|---------------------------------|----------------------------------------------|
| 3.0.1        | 18-10-2024                      | **Analytical Rule** [Process Creation with Suspicious CommandLine Arguments] |
| 3.0.0        | 21-12-2023                      | Initial Solution Release                    	|

---

**Browse:**

- [‚Üê Back to Solutions Index](../solutions-index.md)
- [Solutions](../solutions-index.md)
- [Connectors](../connectors-index.md)
- [Tables](../tables-index.md)
- [Content](../content/content-index.md)
- [ASIM Parsers](../asim/asim-index.md)
- [ASIM Products](../asim/asim-products-index.md)

