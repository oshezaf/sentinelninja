# <img src="../images/asim-badge.png" alt="ASIM" height="32"> User agent search for log4j exploitation attempt

**Browse:** [ğŸ ](../README.md) Â· [Solutions](../solutions-index.md) Â· [Connectors](../connectors-index.md) Â· [Tables](../tables-index.md) Â· [Content](../content/content-index.md) Â· [Parsers](../parsers/parsers-index.md) Â· [ASIM Parsers](../asim/asim-index.md) Â· [ASIM Products](../asim/asim-products-index.md) Â· [ğŸ“Š](../statistics.md)

â†‘ [Back to Content Index](../content/content-index.md)

---

This query uses various log sources having user agent data to look for log4j CVE-2021-44228 exploitation attempt based on user agent pattern. Log4j is an open-source Apache logging library that is used in many Java-based applications. The regex and the string matching look for the most common attacks. This might not be comprehensive to detect every possible user agent variation.  Reference: https://msrc-blog.microsoft.com/2021/12/11/microsofts-response-to-cve-2021-44228-apache-log4j2/

| Attribute | Value |
|:----------|:------|
| **Type** | Analytic Rule |
| **Solution** | [Apache Log4j Vulnerability Detection](../solutions/apache-log4j-vulnerability-detection.md) |
| **ID** | `29283b22-a1c0-4d16-b0a9-3460b655a46a` |
| **Severity** | High |
| **Status** | Available |
| **Kind** | Scheduled |
| **Tactics** | InitialAccess |
| **Techniques** | T1190 |
| **Required Connectors** | [SquidProxy](../connectors/squidproxy.md), [Zscaler](../connectors/zscaler.md), [WAF](../connectors/waf.md), [Office365](../connectors/office365.md), [AzureActiveDirectory](../connectors/azureactivedirectory.md), [AzureActiveDirectory](../connectors/azureactivedirectory.md), [AWS](../connectors/aws.md), [AzureMonitor(IIS)](../connectors/azuremonitor-iis.md) |
| **Source** | [View on GitHub](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Apache%20Log4j%20Vulnerability%20Detection/Analytic%20Rules/UserAgentSearch_log4j.yaml) |

## <img src="../images/asim-logo-small.png" alt="ASIM" height="16"> ASIM Parsers Used

This content item uses ASIM (Advanced Security Information Model) parsers for normalized data:

- [`_Im_WebSession`](../asim/imwebsession.md)

## Tables Used

This content item queries data from the following tables:

| Table | Transformations | Ingestion API |
|:------|:---------------:|:-------------:|
| [`AADNonInteractiveUserSignInLogs`](../tables/aadnoninteractiveusersigninlogs.md) | âœ“ | âœ— |
| [`AWSCloudTrail`](../tables/awscloudtrail.md) | âœ“ | âœ“ |
| [`AzureDiagnostics`](../tables/azurediagnostics.md) | â€” | âœ— |
| [`OfficeActivity`](../tables/officeactivity.md) | âœ“ | âœ— |
| [`SigninLogs`](../tables/signinlogs.md) | âœ“ | âœ— |
| [`W3CIISLog`](../tables/w3ciislog.md) | âœ“ | âœ— |

---

**Browse:** [ğŸ ](../README.md) Â· [Solutions](../solutions-index.md) Â· [Connectors](../connectors-index.md) Â· [Tables](../tables-index.md) Â· [Content](../content/content-index.md) Â· [Parsers](../parsers/parsers-index.md) Â· [ASIM Parsers](../asim/asim-index.md) Â· [ASIM Products](../asim/asim-products-index.md) Â· [ğŸ“Š](../statistics.md)

â†‘ [Back to Analytic Rules](analytic-rules.md) Â· [Back to Apache Log4j Vulnerability Detection](../solutions/apache-log4j-vulnerability-detection.md)

