# Admin promotion after Role Management Application Permission Grant

**Browse:** [ğŸ ](../readme.md) Â· [Solutions](../solutions-index.md) Â· [Connectors](../connectors-index.md) Â· [Tables](../tables-index.md) Â· [Content](../content/content-index.md) Â· [Parsers](../parsers/parsers-index.md) Â· [ASIM Parsers](../asim/asim-index.md) Â· [ASIM Products](../asim/asim-products-index.md) Â· [ğŸ“Š](../statistics.md)

â†‘ [Back to Content Index](../content/content-index.md)

---

'This rule looks for a service principal being granted the Microsoft Graph RoleManagement.ReadWrite.Directory (application) permission before being used to add an Microsoft Entra ID object or user account to an Admin directory role (i.e. Global Administrators). This is a known attack path that is usually abused when a service principal already has the AppRoleAssignment.ReadWrite.All permission granted. This permission allows an app to manage permission grants for application permissions to any A

| Attribute | Value |
|:----------|:------|
| **Type** | Analytic Rule |
| **Solution** | [Microsoft Entra ID](../solutions/microsoft-entra-id.md) |
| **ID** | `f80d951a-eddc-4171-b9d0-d616bb83efdc` |
| **Severity** | High |
| **Status** | Available |
| **Kind** | Scheduled |
| **Tactics** | PrivilegeEscalation, Persistence |
| **Techniques** | T1098.003, T1078.004 |
| **Required Connectors** | [AzureActiveDirectory](../connectors/azureactivedirectory.md) |
| **Source** | [View on GitHub](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Microsoft%20Entra%20ID/Analytic%20Rules/AdminPromoAfterRoleMgmtAppPermissionGrant.yaml) |

## Tables Used

This content item queries data from the following tables:

| Table | Selection Criteria | Transformations | Ingestion API |
|:------|:-------------|:---------------:|:-------------:|
| [`AuditLogs`](../tables/auditlogs.md) | `OperationName == "Add app role assignment to service principal"` | âœ“ | âœ— |

---

**Browse:** [ğŸ ](../readme.md) Â· [Solutions](../solutions-index.md) Â· [Connectors](../connectors-index.md) Â· [Tables](../tables-index.md) Â· [Content](../content/content-index.md) Â· [Parsers](../parsers/parsers-index.md) Â· [ASIM Parsers](../asim/asim-index.md) Â· [ASIM Products](../asim/asim-products-index.md) Â· [ğŸ“Š](../statistics.md)

â†‘ [Back to Analytic Rules](analytic-rules.md) Â· [Back to Microsoft Entra ID](../solutions/microsoft-entra-id.md)

