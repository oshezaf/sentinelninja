# Security Service Registry ACL Modification

**Browse:** [ğŸ ](../readme.md) Â· [Solutions](../solutions-index.md) Â· [Connectors](../connectors-index.md) Â· [Tables](../tables-index.md) Â· [Content](../content/content-index.md) Â· [Parsers](../parsers/parsers-index.md) Â· [ASIM Parsers](../asim/asim-index.md) Â· [ASIM Products](../asim/asim-products-index.md) Â· [ğŸ“Š](../statistics.md)

â†‘ [Back to Content Index](../content/content-index.md)

---

'Identifies attempts to modify registry ACL to evade security solutions. In the Solorigate attack, the attackers were found modifying registry permissions so services.exe cannot access the relevant registry keys to start the service.  The detection leverages Security Event as well as MDE data to identify when specific security services registry permissions are modified.  Only some portions of this detection are related to Solorigate, it also includes coverage for some common tools that perform t

| Attribute | Value |
|:----------|:------|
| **Type** | Analytic Rule |
| **Solution** | Standalone Content |
| **ID** | `473d57e6-f787-435c-a16b-b38b51fa9a4b` |
| **Severity** | High |
| **Kind** | Scheduled |
| **Tactics** | DefenseEvasion |
| **Techniques** | T1562 |
| **Required Connectors** | [SecurityEvents](../connectors/securityevents.md), [MicrosoftThreatProtection](../connectors/microsoftthreatprotection.md), [WindowsSecurityEvents](../connectors/windowssecurityevents.md), [WindowsForwardedEvents](../connectors/windowsforwardedevents.md) |
| **Source** | [View on GitHub](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/SecurityServiceRegistryACLModification.yaml) |

## Tables Used

This content item queries data from the following tables:

| Table | Selection Criteria | Transformations | Ingestion API |
|:------|:-------------|:---------------:|:-------------:|
| [`DeviceProcessEvents`](../tables/deviceprocessevents.md) |  | âœ“ | âœ— |
| [`SecurityEvent`](../tables/securityevent.md) |  | âœ“ | âœ“ |
| [`WindowsEvent`](../tables/windowsevent.md) | `EventID in "4670,4688"` | âœ“ | âœ“ |

## Associated Connectors

The following connectors provide data for this content item:

| Connector | Solution |
|:----------|:---------|
| [ESI-Opt34DomainControllersSecurityEventLogs](../connectors/esi-opt34domaincontrollerssecurityeventlogs.md) | [Microsoft Exchange Security - Exchange On-Premises](../solutions/microsoft-exchange-security-exchange-on-premises.md) |
| [SecurityEvents](../connectors/securityevents.md) | [Windows Security Events](../solutions/windows-security-events.md) |
| [WindowsForwardedEvents](../connectors/windowsforwardedevents.md) | [Windows Forwarded Events](../solutions/windows-forwarded-events.md) |
| [WindowsSecurityEvents](../connectors/windowssecurityevents.md) | [Windows Security Events](../solutions/windows-security-events.md) |

**Solutions:** [Microsoft Exchange Security - Exchange On-Premises](../solutions/microsoft-exchange-security-exchange-on-premises.md), [Windows Forwarded Events](../solutions/windows-forwarded-events.md), [Windows Security Events](../solutions/windows-security-events.md)

---

**Browse:** [ğŸ ](../readme.md) Â· [Solutions](../solutions-index.md) Â· [Connectors](../connectors-index.md) Â· [Tables](../tables-index.md) Â· [Content](../content/content-index.md) Â· [Parsers](../parsers/parsers-index.md) Â· [ASIM Parsers](../asim/asim-index.md) Â· [ASIM Products](../asim/asim-products-index.md) Â· [ğŸ“Š](../statistics.md)

â†‘ [Back to Analytic Rules](analytic-rules.md)

