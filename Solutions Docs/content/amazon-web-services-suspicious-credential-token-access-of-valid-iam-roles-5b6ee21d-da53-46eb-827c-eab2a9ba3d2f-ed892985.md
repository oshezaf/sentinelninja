# Suspicious credential token access of valid IAM Roles

'Adversaries may generate temporary credentials of existing privileged IAM roles to access AWS resources that were not previously accessible to perform malicious actions. The credentials may be generated by trusted IAM user or via AWS Cloud Instance Metadata API. This query will look for AWS STS API Assume Role operations for RoleArn (Role Amazon Resource Names) which was not historically seen. You can also limit the query to only sensitive IAM Roles which needs to be monitored. Read more about

| Attribute | Value |
|:----------|:------|
| **Type** | Hunting Query |
| **Solution** | [Amazon Web Services](../solutions/amazon-web-services.md) |
| **ID** | `5b6ee21d-da53-46eb-827c-eab2a9ba3d2f` |
| **Tactics** | InitialAccess, DefenseEvasion |
| **Techniques** | T1078 |
| **Required Connectors** | [AWS](../connectors/aws.md), [AWSS3](../connectors/awss3.md) |
| **Source** | [View on GitHub](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Hunting%20Queries/AWS_SuspiciousCredentialTokenAccessOfValid_IAM_Roles.yaml) |

## Tables Used

This content item queries data from the following tables:

- [`AWSCloudTrail`](../tables/awscloudtrail.md)

---

**Browse:** [ğŸ ](../readme.md) Â· [Solutions](../solutions-index.md) Â· [Connectors](../connectors-index.md) Â· [Tables](../tables-index.md) Â· [Content](../content/content-index.md) Â· [Parsers](../parsers/parsers-index.md) Â· [ASIM Parsers](../asim/asim-index.md) Â· [ASIM Products](../asim/asim-products-index.md)

â†‘ [Back to Hunting Queries](hunting-queries.md) Â· [Back to Amazon Web Services](../solutions/amazon-web-services.md)

