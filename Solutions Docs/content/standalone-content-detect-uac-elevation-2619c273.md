# detect-uac-elevation

**Browse:** [ğŸ ](../readme.md) Â· [Solutions](../solutions-index.md) Â· [Connectors](../connectors-index.md) Â· [Tables](../tables-index.md) Â· [Content](../content/content-index.md) Â· [Parsers](../parsers/parsers-index.md) Â· [ASIM Parsers](../asim/asim-index.md) Â· [ASIM Products](../asim/asim-products-index.md)

â†‘ [Back to Content Index](../content/content-index.md)

---

This query identifies UAC elevated processes by analyzing launches of consent.exe (the process that performs UAC elevation). The first parameter of consent.exe is the process ID being elevated, therefore we extract this value and use a combination of that ID and the DeviceId to join it with processes that ran UAC elevated on the device. Given that process IDs can be reused,  a time filter is performed to ensure that the elevation request and the process launch occur within a specified period of

| Attribute | Value |
|:----------|:------|
| **Type** | Hunting Query |
| **Solution** | [Standalone Content](../solutions/standalone-content.md) |
| **Tactics** | Execution |
| **Required Connectors** | [MicrosoftThreatProtection](../connectors/microsoftthreatprotection.md) |
| **Source** | [View on GitHub](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Hunting%20Queries/Hunting%20Queries/Microsoft%20365%20Defender/Execution/detect-uac-elevation.yml) |

## Tables Used

This content item queries data from the following tables:

- [`DeviceProcessEvents`](../tables/deviceprocessevents.md)

---

**Browse:** [ğŸ ](../readme.md) Â· [Solutions](../solutions-index.md) Â· [Connectors](../connectors-index.md) Â· [Tables](../tables-index.md) Â· [Content](../content/content-index.md) Â· [Parsers](../parsers/parsers-index.md) Â· [ASIM Parsers](../asim/asim-index.md) Â· [ASIM Products](../asim/asim-products-index.md)

â†‘ [Back to Hunting Queries](hunting-queries.md) Â· [Back to Standalone Content](../solutions/standalone-content.md)

